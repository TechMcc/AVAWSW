<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Speech Recognition</title>
</head>
<body>
<h1>(^_-)V</h1>
<select id="lang">
  <option value="ja-JP">JA</option>
  <option value="en-US">EN</option>
</select>
<input type="button" id="recog_start" value="Start!" onclick="recogStart();">
<input type="button" id="recog_stop" value="Stop!" onclick="recogStop();">

<script src="/socket.io/socket.io.js"></script>
<script>
var socket=io.connect();
var recog;
function recogStart () {
  recog=new webkitSpeechRecognition();
  recog.lang=document.querySelector('#lang').value;
  recog.continuous=true;
  recog.interimResults = true;
  recog.onresult=function(res){
    var correct='';
    var unsure='';
    for (var i=0;i<res.results.length;i++) {
      if (res.results[i].isFinal) {
        correct+=res.results[i][0].transcript;
      } else {
        unsure+=res.results[i][0].transcript;
      }
      socket.emit('recogresult',correct);
    }
  };
  recog.start();
};

function recogStop(){
  recog.stop();
}



</script>
</body>
</html>
